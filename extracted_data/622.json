{
  "id": "622",
  "title": "The loss surface of residual networks: Ensembles and the role of batch normalization",
  "abstract": "Deep Residual Networks present a premium in performance in comparison to conventional networks of the same depth and are trainable at extreme depths. It has recently been shown that Residual Networks behave like ensembles of relatively shallow networks. We show that these ensemble are dynamic: while initially the virtual ensemble is mostly at depths lower than half the networkâ€™s depth, as training progresses, it becomes deeper and deeper. The main mechanism that controls the dynamic ensemble behavior is the scaling introduced, e.g., by the Batch Normalization technique. We explain this behavior and demonstrate the driving force behind it. As a main tool in our analysis, we employ generalized spin glass models, which we also use in order to study the number of critical points in the optimization of Residual Networks.",
  "accepted": false,
  "zeroShot": [
    {
      "model": "claude-haiku-4-5",
      "decision": {
        "rejection": false,
        "confidence": 0.72,
        "primary_reason": "Novel theoretical analysis connecting ResNets to spin glass models with insights on dynamic ensemble behavior and batch normalization's role. Strong mathematical framework but relies on strong assumptions (A1-A4) that authors acknowledge are unrealistic. Experimental validation is limited to toy problems and CIFAR datasets without comprehensive comparisons. The work makes solid theoretical contributions to understanding ResNet optimization but has gaps between theory (which requires independence assumptions) and practice (where these don't hold)."
      },
      "token": {
        "prompt_tokens": 8234,
        "completion_tokens": 123,
        "total_tokens": 8357
      },
      "time": "2026-02-05T23:05:11.810866+00:00"
    }
  ],
  "article": [
    {
      "heading": "1 INTRODUCTION",
      "text": "Residual Networks (He et al., 2015) (ResNets) are neural networks with skip connections. These networks, which are a specific case of Highway Networks (Srivastava et al., 2015), present state of the art results in the most competitive computer vision tasks including image classification and object detection. The success of residual networks was attributed to the ability to train very deep networks when employing skip connections (He et al., 2016). A complementary view is presented by Veit et al. (2016), who attribute it to the power of ensembles and present an unraveled view of ResNets that depicts ResNets as an ensemble of networks that share weights, with a binomial depth distribution around half depth. They also present experimental evidence that short paths of lengths shorter than half-depth dominate the ResNet gradient during training. The analysis presented here shows that ResNets are ensembles with a dynamic depth behavior. When starting the training process, the ensemble is dominated by shallow networks, with depths lower than half-depth. As training progresses, the effective depth of the ensemble increases. This increase in depth allows the ResNet to increase its effective capacity as the network becomes more and more accurate. Our analysis reveals the mechanism for this dynamic behavior and explains the driving force behind it. This mechanism remarkably takes place within the parameters of Batch Normalization (Ioffe & Szegedy, 2015), which is mostly considered as a normalization and a fine-grained whitening mechanism that addresses the problem of internal covariate shift and allows for faster learning rates. We show that the scaling introduced by batch normalization determines the depth distribution in the virtual ensemble of the ResNet. These scales dynamically grow as training progresses, shifting the effective ensemble distribution to bigger depths. The main tool we employ in our analysis is spin glass models. Choromanska et al. (2015a) have created a link between conventional networks and such models, which leads to a comprehensive study of the critical points of neural networks based on the spin glass analysis of Auffinger et al. (2013). In our work, we generalize these results and link ResNets to generalized spin glass models. These models allow us to analyze the dynamic behavior presented above. Finally, we apply the results of Auffinger & Arous (2013) in order to study the loss surface of ResNets.",
      "exclude": true
    },
    {
      "heading": "2 A RECAP OF CHOROMANSKA ET AL. (2015A)",
      "text": "We briefly summarize Choromanska et al. (2015a), which connects the loss function of multilayer networks with the hamiltonian of the p spherical spin glass model, and state their main contributions and results. The notations of our paper are summarized in Appendix A and slightly differ from those in Choromanska et al. (2015a). A simple feed forward fully connected network N , with p layers and a single output unit is considered. Let ni be the number of units in layer i, such that n0 is the dimension of the input, and np = 1. It is further assumed that the ReLU activation functions denoted by R() are used. The output Y of the network given an input vector x Rd can be expressed as Y = d i=1 j=1 xijAij p k=1 w (k) ij , (1) where the first summation is over the network inputs x1...xd, and the second is over all paths from input to output. There are = p i=1 ni such paths and i, xi1 = xi2 = ...xi . The variable Aij 0, 1 denotes whether the path is active, i.e., whether all of the ReLU units along this path are producing positive activations, and the product p k=1 w (k) ij represents the specific weight configurationw1ij ...w k ij multiplying xi given path j. It is assumed throughout the paper that the input variables are sampled i.i.d from a normal Gaussian distribution. Definition 1. The mass of the network N is defined as = p i=0 ni. The variablesAij are modeled as independent Bernoulli random variables with a success probability , i.e., each path is equally likely to be active. Therefore, EA[Y ] = d i=1 j=1 xij p k=1 w (k) ij . (2) The task of binary classification using the networkN with parameters w is considered, using either the hinge loss LhN or the absolute loss LaN : LhN (w) = EA[max(0, 1 YxY )], LaN (w) = EA[|Yx Y |] (3) where Yx is a random variable corresponding to the true label of sample x. In order to equate either loss with the hamiltonian of the p-spherical spin glass model, a few key approximations are made: A1 Variable independence - The inputs xij are modeled as independent normal Gaussian random variables. A2 Redundancy in network parameterization - It is assumed the set of all the network weights [w1, w2...wN ] contains only unique weights such that 0. These assumptions are made for the sake of analysis, and do not necessarily hold. The validity of these assumption was posed as an open problem in Choromanska et al. (2015b), where a different degree of plausibility was assigned to each. Specifically, A1, as well as the independence assumption of Aij , were deemed unrealistic, and A2 - A4 as plausible. For example, A1 does not hold since each input xi is associated with many different paths and xi1 = xi2 = ...xi . See Choromanska et al. (2015a) for further justification of these approximations. Under A1A4, the loss takes the form of a centered Gaussian process on the sphere S1( ). Specifically, it is shown to resemble the hamiltonian of the a spherical p-spin glass model given by: Hp,(w) = 1 p1 2 i1...ip xi1...ip r k=1 wik (5) with spherical constraint 1 i=1 w2i = 1 (6) where xi1...ip are independent normal Gaussian variables. In Auffinger et al. (2013), the asymptotic complexity of spherical p spin glass model is analyzed based on random matrix theory. In Choromanska et al. (2015a) these results are used in order to shed light on the optimization process of neural networks. For example, the asymptotic complexity of spherical spin glasses reveals a layered structure of low-index critical points near the global optimum. These findings are then given as a possible explanation to several central phenomena found in neural networks optimization, such as similar performance of large nets, and the improbability of getting stuck in a bad local minima. As part of our work, we follow a similar path. First, a link is formed between residual networks and the hamiltonian of a general multi-interaction spherical spin glass model as given by: Hp,(w) = p r=1 r r1 2 i1,i2...ir=1 xi1,i2...ir r k=1 wik (7) where 1... p are positive constants. Then, using Auffinger & Arous (2013), we obtain insights on residual networks. The other part of our work studies the dynamic behavior of residual networks, where we relax the assumptions made for the spin glass model.",
      "exclude": false
    },
    {
      "heading": "3 RESIDUAL NETS AND GENERAL SPIN GLASS MODELS",
      "text": "We begin by establishing a connection between the loss function of deep residual networks and the hamiltonian of the general spherical spin glass model. We consider a simple feed forward fully connected network N , with ReLU activation functions and residual connections. For simplicity of notations without the loss of generality, we assume n1 = ... = np = n. n0 = d as before. In our ResNet model, there exist p 1 identity connections skipping a single layer each, starting from the first hidden layer. The output of layer l > 1 is given by: Nl(x) = R(W>l Nl1(x)) +Nl1(x) (8) where Wl denotes the weight matrix connecting layer l 1 with layer l. Notice that the first hidden layer has no parallel skip connection, and so N1(x) = R(W>1 x). Without loss of generality, the scalar output of the network is the sum of the outputs of the output layer p and is expressed as Y = p r=1 d i=1 r j=1 x (r) ij A (r) ij r k=1 w (r)(k) ij (9) where A(r)ij 0, 1 denotes whether path j of length r is open, and j, j, r, r xrij = xr ij . The residual connections in N imply that the output Y is now the sum of products of different lengths, indexed by r. Since our ResNet model attaches a skip connection to every layer except the first, 1 r p. See Sec. 6 regarding models with less frequent skip connections. Each path of length r includes r 1 non-skip connections (those involving the first term in Eq. 8 and not the second, identity term) out of layers l = 2..p. Therefore, r = ( p1 r1 ) nr. We define the following measure on the network: Definition 2. The mass of a depth r subnetwork in N is defined as r = dr. The properties of redundancy in network parameters and their uniform distribution, as described in Sec. 2, allow us to re-index Eq. 9. Lemma 1. Assuming assumptions A2 A4 hold, and n Z, then the output can be expressed after reindexing as: Y = p r=1 i1,i2...ir=1 r r j=1 x (j) i1,i2...ir A (j) i1,i2...ir r k=1 wik . (10) All proofs can be found in Appendix B. Making the modeling assumption that the ReLU gates are independent Bernoulli random variables with probability , we obtain that for every path of length r, EA(j)i1,i2...ir = r and EA[Y ] = p r=1 i1,i2...ir=1 r r j=1 x (j) i1,i2...ir r r k=1 wik . (11) In order to connect ResNets to generalized spherical spin glass models, we denote the variables: i1,i2...ir = r r j=1 xji1,i2...ir , xi1,i2...ir = i1,i2...ir Ex[2i1,i2...ir ] 1 2 (12) Note that since the input variables x1...xd are sampled from a centered Gaussian distribution (dependent or not), then the set of variables xi1,i2...ir are dependent normal Gaussian variables. Lemma 2. Assuming A2A3 hold, and n N then r,i1...ir the following holds: 1 d ( r r )2 E[2i1,i2...ir ] ( r r )2. (13) We approximate the expected output EA(Y ) with Y by assuming the minimal value in 13 holds such that r,i1...ir E[2i1,i2...ir ] = 1 d ( r r ) 2. This approximation holds exactly when = n, since all weight configurations of a particular length in Eq. 10 will appear the same number of times. When 6= n, the uniformity assumption dictates that each configuration of weights would appear approximately equally regardless of the inputs, and the expectation values would be very close to the lower bound. The following expression for Y is thus obtained: Y = p r=1 ( )r r d i1,i2...ir=1 xi1,i2...ir r k=1 wik . (14) The independence assumption A1 was not assumed yet, and 14 holds regardless. Assuming A4 and denoting the scaled weights wi = 1Cwi, we can link the distribution of Y to the distribution on x: Y = p r=1 r d ( C )r i1,i2...ir=1 xi1,i2...ir r k=1 wik = z p r=2 r r1 2 i1,i2...ir=1 xi1,i2...ir r k=1 wik (15) where r = r = 1z ( p1 r1 ) (nC )r and z is a normalization factor such that p r=1 2 r = 1. The following lemma gives a generalized expression for the binary and hinge losses of the network. Lemma 3 ( Choromanska et al. (2015a)). Assuming assumptions A2 A4 hold, then both the losses LhN (x) and LaN (x) can be generalized to a distribution of the form: LN (x) = C1 + C2Y (16) where C1, C2 are positive constants that do not affect the optimization process. The model in Eq. 16 has the form of a spin glass model, except for the dependency between the variables xi1,i2...ir . We later use an assumption similar to A1 of independence between these variables in order to link the two binary classification losses and the general spherical spin glass model. However, for the results in this section, this is not necessary. We denote the important quantities: = nC , r = 1 z ( p 1 r 1 ) r (17) The series ( r) p r=1 determines the weight of interactions of a specific length in the loss surface. Notice that for constant depth p and large enough , arg maxr( r) = p. Therefore, for wide networks, where n and, therefore, are large, interactions of order p dominate the loss surface, and the effect of the residual connections diminishes. Conversely, for constant and a large enough p (deep networks), we have that arg maxr( r) < p, and can expect interactions of order r < p to dominate the loss. The asymptotic behavior of is captured by the following lemma: Theorem 1. Assuming 1+ p N, we have that: lim p 1 p arg max r ( r) = 1 + (18) As the next theorem shows, the epsilons are concentrated in a narrow band near the maximal value. Theorem 2. For any 1 < 1+ < 2, and assuming 1p, 2p, 1+ p N, it holds that: lim p 2p r=1p 2r = 1 (19) Thm. 2 implies that for deep residual networks, the contribution of weight products of order far away from the maximum 1+ p is negligible. The loss is, therefor, similar in complexity to that of an ensemble of potentially shallow conventional nets. The next Lemma shows that we can shift the effective depth to any value by simply controlling C. Lemma 4. For any integer 1 k p there exists a global scaling parameter C such that arg maxr( r(C)) = k. A simple global scaling of the weights is, therefore, enough to change the loss surface, from an ensemble of shallow conventional nets, to an ensemble of deep nets. This is illustrated in Fig. 1(a-c) for various values of . In a common weight initialization scheme for neural networks,C = 1 n (Orr & Muller, 2003; Glorot & Bengio, 2010). With this initialization and = n, = and the maximal weight is obtained at less than half the networks depth limp arg maxr( r) < p 2 . Therefore, at the initialization, the loss function is primarily influenced by interactions of considerably lower order than the depth p, which facilitates easier optimization.",
      "exclude": false
    },
    {
      "heading": "4 DYNAMIC BEHAVIOR OF RESIDUAL NETS",
      "text": "The expression for the output of a residual net in Eq. 15 provides valuable insights into the machinery at work when optimizing such models. Thm. 1 and 2 imply that the loss surface resembles that of an ensemble of shallow nets (although not a real ensemble due to obvious dependencies), with various depths concentrated in a narrow band. As noticed in Veit et al. (2016), viewing ResNets as ensembles of relatively shallow networks helps in explaining some of the apparent advantages of these models, particularly the apparent ease of optimization of extremely deep models, since deep paths barely affect the overall loss of the network. However, this alone does not explain the increase in accuracy of deep residual nets over actual ensembles of standard networks. In order to explain the improved performance of ResNets, we make the following claims: 1. The distribution of the depths of the networks within the ensemble is controlled by the scaling parameter C. 2. During training, C changes and causes a shift of focus from a shallow ensemble to deeper and deeper ensembles, which leads to an additional capacity. 3. In networks that employ batch normalization, C is directly embodied as the scale parameter . The starting condition of = 1 offers a good starting condition that involves extremely shallow nets. For the remainder of Sec.4, we relax all assumptions, and assume that at some point in time 1 i=1 w 2 i = C 2, and = N . Using Eq. 9 for the output of the network Y in Lemma. 3, the loss can be expressed: LN (x,w) = C1 + C2 p r=1 d i=1 r j=1 x (r) ij A (r) ij r k=1 w (r)(k) ij (20) where C1, C2 are some constants that do not affect the optimization process. In order to gain additional insight into this dynamic mechanism, we investigate the derivative of the loss with respect to the scale parameter C. Using Eq. 9 for the output, we obtain: LN (x,w) C = C2 C p r=1 r d i=1 r j=1 x (r) ij A (r) ij r k=1 w (r)(k) ij (21) Notice that the addition of a multiplier r indicates that the derivative is increasingly influenced by deeper networks.",
      "exclude": false
    },
    {
      "heading": "4.1 BATCH NORMALIZATION",
      "text": "Batch normalization has shown to be a crucial factor in the successful training of deep residual networks. As we will show, batch normalization layers offer an easy starting condition for the network, such that the gradients from early in the training process will originate from extremely shallow paths. We consider a simple batch normalization procedure, which ignores the additive terms, has the output of each ReLU unit in layer l normalized by a factor l and then is multiplied by some parameter l. The output of layer l > 1 is therefore: Nl(x) = l l R(W>l Nl1(x)) +Nl1(x) (22) where l is the mean of the estimated standard deviations of various elements in the vector R(W>l Nl1(x)). Furthermore, a typical initialization of batch normalization parameters is to set l, l = 1. In this case, providing that units in the same layer have equal variance l, the recursive relation E[Nl+1(x)2j ] = 1 + E[Nl(x)2j ] holds for any unit j in layer l. This, in turn, implies that the output of the ReLU units should have increasing variance 2l as a function of depth. Multiplying the weight parameters in deep layers with an increasingly small scaling factor 1l , effectively reduces the influence of deeper paths, so that extremely short paths will dominate the early stages of optimization. We next analyze how the weight scaling, as introduced by batch normalization, provides a driving force for the effective ensemble to become deeper as training progresses.",
      "exclude": false
    },
    {
      "heading": "4.2 THE DRIVING FORCE BEHIND THE SCALE INCREASE",
      "text": "The analysis below focuses on a single residual connection skipping a block of one or more layers. Since it holds for each block individually, it holds also for a residual network of multiple skipped blocks of arbitrary depth. We consider a simple network of depth p, with a single residual connection skipping p m layers. We further assume that batch normalization is applied at the output of each ReLU unit as described in Eq. 22. We denote by l1...lm the indices of layers that are not skipped by the residual connection, and m = m i=1 li li , p = p i=1 i i . Since every path of length m is multiplied by m, and every path of length p is multiplied by p, the expression for the loss can be expressed using Eq. 20 and ignoring constant terms: LN (x,w) = m d i=1 m j=1 x (m) ij A (m) ij r k=1 w (m)(k) ij + p d i=1 p j=1 x (m) ij A (p) ij p k=1 w (p)(k) ij = Lm(x,w) + Lp(x,w) (23) We denote by w the derivative operator with respect to the parameters w, and the gradient g = wLN (x,w) = gm + gp evaluated at point w. Theorem 3. Considering the loss in 23, and assuming LN (x,w)l = 0, then for a small learning rate 0 |l| (24) 2. For any l 6l1...lm , if gp22 + g>p gm > 0 then:l LN (x,w g)l > |l| (25) Thm. 3 suggests that |l| will increase for layers l that do not have skip-connections. Conversely, if layer l has a parallel skip connection, then |l| will increase if gp2 > gm2, where the later condition implies that shallow paths are nearing a local minima. Notice that an increase in |l 6l1...lm | results in an increase in |p|, while |m| remains unchanged, therefore shifting the balance into deeper ensembles. This steady increase of |l|, as predicted in our theoretical analysis, is also backed in experimental results, as depicted in Fig. 1(d). Note that the first layer, which cannot be skipped, behaves differently than the other layers. More experiments can be found in Appendix C. It is worth noting that the mechanism for this dynamic property of residual networks can also be observed without the use of batch normalization, as a steady increase in the L2 norm of the weights, as shown in Fig. 1(e). In order to model this, consider the residual network as discussed above, without batch normalization layers. Recalling, w2 = C , w = wC , the loss of this network is expressed as: LN (x,w) = Cm d i=1 m j=1 x (m) ij A (m) ij r k=1 w (m)(k) ij + C p d i=1 p j=1 x (m) ij A (p) ij p k=1 w (p)(k) ij = Lm(x,w) + Lp(x,w) (26) Theorem 4. Considering the loss in 26, and assuming LN (x,w)C = 0, then for a small learning rate 0 p gm) (27) Thm. 4 indicates that if either gp2 or gm2 is dominant (for example, near local minimas of the shallow network, or at the start of training), the scaling of the weights C will increase. This expansion will, in turn, emphasize the contribution of deeper paths over shallow paths, and increase the overall capacity of the residual network. This dynamic behavior of the effective depth of residual networks is of key importance in understanding the effectiveness of these models. While optimization starts off rather easily with gradients largely originating from shallow paths, the overall advantage of depth is still maintained by the dynamic increase of the effective depth.",
      "exclude": false
    },
    {
      "heading": "5 THE LOSS SURFACE OF ENSEMBLES",
      "text": "We now present the results of Auffinger & Arous (2013) regarding the asymptotic complexity in the case of lim of the multi-spherical spin glass model given by: H , = r=2 r r1 2 i1,...ir=1 Jri1...ir wi2 ...wir (28) where Jri1...ir are independent centered standard Gaussian variables, and = ( r)r>2 are positive real numbers such that r=2 r2 r 0: k(R, ) = 1 2 log( v v ) v v v + v (33) Eq. 33 provides the asymptotic mean total number of critical points with non-diverging index k. It is presumed that the SGD algorithm will easily avoid critical points with a high index that have many descent directions, and maneuver towards low index critical points. We, therefore, investigate how the mean total number of low index critical points vary as the ensemble distribution embodied in ( r)r>2 changes its shape by a steady increase in . Fig. 1(f) shows that as the ensemble progresses towards deeper networks, the mean amount of low index critical points increases, which might cause the SGD optimizer to get stuck in local minima. This is, however, resolved by the the fact that by the time the ensemble becomes deep enough, the loss function has already reached a point of low energy as shallower ensembles were more dominant earlier in the training. In the following theorem, we assume a finite ensemble such that r=p+1 r2 r 0. Theorem 5. For any k N, p > 1, we denote the solution to the following constrained optimization problems: = arg max k(R, ) s.t p r=2 2r = 1 (34) It holds that: r = 1, r = p 0, otherwise (35) Thm. 5 implies that any heterogeneous mixture of spin glasses contains fewer critical points of a finite index, than a mixture in which only p interactions are considered. Therefore, for any distribution of that is attainable during the training of a ResNet of depth p, the number of critical points is lower than the number of critical points for a conventional network of depth p.",
      "exclude": false
    },
    {
      "heading": "6 DISCUSSION",
      "text": "In this work, we use spin glass analysis in order to understand the dynamic behavior ResNets display during training and to study their loss surface. In particular, we use at one point or another the assumptions of redundancy in network parameters, near uniform distribution of network weights, independence between the inputs and the paths and independence between the different copies of the input as described in Choromanska et al. (2015a). The last two assumptions, i.e., the two independence assumptions, are deemed in Choromanska et al. (2015b) as unrealistic, while the remaining are considered plausible. Our analysis of critical points in ensembles (Sec. 5) requires all of the above assumptions. However, Thm. 1 and 2, as well as Lemma. 4, do not assume the last assumption, i.e., the independence between the different copies of the input. Moreover, the analysis of the dynamic behavior of residual nets (Sec. 4) does not assume any of the above assumptions. Our results are well aligned with some of the results shown in Larsson et al. (2016), where it is noted empirically that the deepest column trains last. This is reminiscent of our claim that the deeper networks of the ensemble become more prominent as training progresses. The authors of Larsson et al. (2016) hypothesize that this is a result of the shallower columns being stabilized at a certain point of the training process. In our work, we discover the exact driving force that comes into play. In addition, our work offers an insight into the mechanics of the recently proposed densely connected networks (Huang et al., 2016). Following the analysis we provide in Sec. 3, the additional shortcut paths decrease the initial capacity of the network by offering many more short paths from input to output, thereby contributing to the ease of optimization when training starts. The driving force mechanism described in Sec. 4.2 will then cause the effective capacity of the network to increase. Note that the analysis presented in Sec. 3 can be generalized to architectures with arbitrary skip connections, including dense nets. This is done directly by including all of the induced sub networks in Eq. 9. The reformulation of Eq. 10 would still holds, given that r is modified accordingly.",
      "exclude": true
    },
    {
      "heading": "7 CONCLUSION",
      "text": "Ensembles are a powerful model for ResNets, which unravels some of the key questions that have surrounded ResNets since their introduction. Here, we show that ResNets display a dynamic ensemble behavior, which explains the ease of training such networks even at very large depths, while still maintaining the advantage of depth. As far as we know, the dynamic behavior of the effective capacity is unlike anything documented in the deep learning literature. Surprisingly, the dynamic mechanism typically takes place within the outer multiplicative factor of the batch normalization module.",
      "exclude": true
    },
    {
      "heading": "A SUMMARY OF NOTATIONS",
      "text": "Table 1 presents the various symbols used throughout this work and their meaning.",
      "exclude": false
    },
    {
      "heading": "B PROOFS",
      "text": "Proof of Lemma 1. There are a total of r paths of length r from input to output, and a total of r unique r length configurations of weights. The uniformity assumption then implies that each configuration of weights is repeated rr times. By summing over the unique configurations, and re indexing the input we arrive at Eq. 10. Proof of Lemma 2. From 12, we have that i1,i2...ir is defined as a sum of r r inputs. Since there are only p distinct inputs, it holds that for each i1,i2...ir there exists a sequence = (i) p i=1 N such that d i=1 i = r r , and i1,i2...ir = d i=1 ixi. We, therefore, have that E[2i1,i2...ir ] = 2 2. Note that the minimum value of E[2i1,i2...ir ] is a solution to the following: min(E[2i1,i2...ir ]) = min(2) s.t 1 = r r , (i) p i=1 N, (36) which achieves its minimal value at i, i = 1d r r . Similarly, the maximum value is achieved at i = r r i for some index i. Proof of Thm. 1. We use the stirling approximation, which states limp 1p log( ( p p ) ) = H(), where H() = log() (1)log(1). Ignoring the constants which do not depend on , lim p 1 p log( ( p p ) p) = H() + log() (37) which achieves its maximum value at = . Proof of Thm. 2. For brevity, we provide a sketch of the proof. It is enough to show that limp 1p r=1 2 r = 0 for 1, Pp(x) 12p (x+ x21)p+ 1 2 (x21) 1 4 . For the term in the nominator of Eq. 38 , we use the Stirling approximation for factorials p! 2p(pe ) p. Substituting both approximations in Eq. 38 and taking the limit completes the proof. Proof of Lemma 4. For simplicity, we ignore the constants in the binomial coefficient, and assume r = 1 z ( p r ) r. Notice that for = ( p p 2 ) , we have that arg maxr( r( )) = p, arg maxr( r( 1 )) = 1 and arg maxr( r(1)) = p 2 . From the monotonicity and continuity of r, any value 1 k p can be attained. The linear dependency (C) = nC completes the proof. Proof of Thm. 3. 1. Notice that by definition, layer l is not skipped by the residual connection, and therefore l multiplies every path in the network. Therefore, LN (x,w) l = 1l (Lm(x,w) + Lp(x,w)). Using taylor series expansion: LN (x,w g) l LN (x,w) l w LN (x,w) l g (40) Substitutingw LN (x,w)l = 1 l (gm + gp) in 40 we have: LN (x,w gw) l 0 1 l (gm + gp) >(gm + gp) = 1 l gm + gp22 gp = 1 l (g>mgp + gp22) (44) The condition gp2 > gm2 implies that g>mgp + gp22 > 0, completing the proof. Proof of Thm 4. Notice that LN (x,w)C = LN (x,w) w w w2 = g>w = 0, and hence the gradient is orthogonal to the weights. We have that LN (x,w)C = 1 C (mLm(x,w) + pLp(x,w)). Using taylor series expansion we have: LN (x,w g) C LN (x,w) C w LN (x,w) C g (45) For the last term we have: w LN (x,w) C g = (mLm(x,w) + pLp(x,w))w w2 g + 1 C (mgm + pgp) >g = (mLm(x,w) + pLp(x,w)) w>g C 3 2 + 1 C (mgm + pgp) >g = 1 C (mgm + pgp) >g, (46) where the last step stems from the fact thatw>g = 0. Substitutingw LN (x,w)C = 1 C (mgm+pgp) in 45 we have: LN (x,w gw) C 0 1 C (mgm + pgp) >(gm + gp) = 1 C (mgp22 + pgp22 + (m+ p)g>p gm) (47) Proof of Thm 5. Inserting Eq. 31 into Eq. 33 we have that: k(R, ) = 1 2 log( p r=2 2 rr(r 1)p r=2 2 rr ) p r=2 2 rr(r 2)p r=2 2 rr 2 (48) We denote the matrices V and V such that V ij = rij and V ij = r(r 1)ij . We then have: k(R, ) = 1 2 log( >V >V ) >(V V ) >(V + V ) (49) max k(R, ) max ( 1 2 log( >V >V ))min ( >(V V ) >(V + V ) ) = 1 2 log ( maxi(V iiV 1 ii ) ) mini ( (V ii V ii)(V ii + V ii)1 ) = 1 2 log(p 1) (1 2 p ) = k(R, ) (50)",
      "exclude": false
    },
    {
      "heading": "C ADDITIONAL EXPERIMENTS",
      "text": "Fig. 1(d) and 1(e) report the experimental results of a straightforward setting, in which the task is to classify a mixture of 10 multivariate Gaussians in 50D. The input is therefore of size 50. The loss employed is the cross entropy loss of ten classes. The network has 10 blocks, each containing 20 hidden neurons, a batch normalization layer, and a skip connection. Training was performed on 10,000 samples, using SGD with minibatches of 50 samples. Next, we provide additional experiments performed on the public CIFAR-10 and CIFAR-100 data sets (Krizhevsky, 2009). The public ResNet code of https://github.com/facebook/fb. resnet.torch is used for networks of depth 32. As noted in Sec. 4.2, the dynamic behavior can be present in the Batch Normalization multiplicative coefficient or in the weight matrices themselves. In the following experiments, it seems that until the learning rate is reduced, the dynamic behavior is manifested in the Batch Normalization multiplicative coefficients and then it moves to the convolution layers themselves. We therefore absorb the BN coefficients into the convolutional layer using the public code of https: //github.com/e-lab/torch-toolbox/tree/master/BN-absorber. Note that the multiplicative coefficient of Batch Normalization is typically refereed to as . However, throughout our paper, since we follow the notation of Choromanska et al. (2015a), refers to the number of paths. The multiplicative factor of Batch normalization appears as in Sec. 4. Fig. 2 depicts the results. There are two types of plots: Fig. 2(a,c) presents for CIFAR-10 and CIFAR-100 respectively the magnitude of the various convolutional layers for multiple epochs (similar in type to Fig. 1(d) in the paper). Fig. 2(b,d) depict for the two datasets the mean of these norms over all convolutional layers as a function of epoch (similar to Fig. 1(e)). As can be seen, the dynamic phenomenon we describe is very prominent in the public ResNet implementation when applied to these conventional datasets: the dominance of paths with fewer skip connections increases over time. Moreover, once the learning rate is reduced in epoch 81 the phenomenon we describe speeds up. In Fig. 3 we present the multiplicative coefficient of the Batch Normalization when not absorbed. As future work, we would like to better understand why these coefficients start to decrease once the learning rate is reduced. As shown above, taking the magnitude of the convolutions into account, the dynamic phenomenon we study becomes even more prominent at this point. The change of location from the multiplicative coefficient of the Batch Normalization layers to the convolutions themselves might indicate that Batch Normalization is no longer required at this point. Indeed, Batch Normalization enables larger training rates and this shift happens exactly when the training rate is reduced. A complete analysis is left for future work.",
      "exclude": false
    }
  ]
}